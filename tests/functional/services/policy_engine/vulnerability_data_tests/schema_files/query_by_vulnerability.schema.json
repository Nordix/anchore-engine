{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "query_by_vulnerability.schema.json",
    "required": ["vulnerable_images"],
    "type": "object",
    "properties": {
        "vulnerable_images": {
            "id": "vulnerable_images",
            "type": "array",
            "items": {
                "id": "0",
                "required": ["image", "vulnerable_packages"],
                "type": "object",
                "properties": {
                    "image": {
                        "id": "image",
                        "required": ["analyzed_at", "imageDigest", "imageId", "tag_history"],
                        "type": "object",
                        "properties": {
                            "analyzed_at": {
                                "id": "analyzed_at",
                                "type": "string"
                            },
                            "imageDigest": {
                                "id": "imageDigest",
                                "type": "string"
                            },
                            "imageId": {
                                "id": "imageId",
                                "type": "string"
                            },
                            "tag_history": {
                                "id": "tag_history",
                                "type": "array",
                                "items": {
                                    "id": "0",
                                    "required": ["fulltag", "registry", "repo", "tag", "tag_detected_at"],
                                    "type": "object",
                                    "properties": {
                                        "fulltag": {
                                            "id": "fulltag",
                                            "type": "string"
                                        },
                                        "registry": {
                                            "id": "registry",
                                            "type": "string"
                                        },
                                        "repo": {
                                            "id": "repo",
                                            "type": "string"
                                        },
                                        "tag": {
                                            "id": "tag",
                                            "type": "string"
                                        },
                                        "tag_detected_at": {
                                            "id": "tag_detected_at",
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "vulnerable_packages": {
                        "id": "vulnerable_packages",
                        "type": "array",
                        "items": {
                            "id": "0",
                            "required": ["name", "namespace", "severity", "type", "version"],
                            "type": "object",
                            "properties": {
                                "name": {
                                    "id": "name",
                                    "type": "string"
                                },
                                "namespace": {
                                    "id": "namespace",
                                    "type": "string"
                                },
                                "severity": {
                                    "id": "severity",
                                    "type": "string"
                                },
                                "type": {
                                    "id": "type",
                                    "type": "string"
                                },
                                "version": {
                                    "id": "version",
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}